const cardsContaner=document.querySelector(".cards-contaner");let start=document.querySelector(".start"),cards=[],pages=[];const changeSort=document.getElementById("change-sort"),paginBox=document.getElementById("pagination-container"),getProducts=async()=>{const e=await fetch("https://www.lenvendo.ru/api/js-test-task/"),t=await e.json();showProducts(t.products),showPagination(Math.ceil(t.total_count/t.products.length)),changeSort.onchange=function(){"price-up"===this.value&&(clearHtml(),cards.sort(((e,t)=>e.crPrice-t.crPrice)),renderHtml()),"price-down"===this.value&&(clearHtml(),cards.sort(((e,t)=>t.crPrice-e.crPrice)),renderHtml()),"name-up"===this.value&&(clearHtml(),cards.sort((function(e,t){let r=e.crName.toLowerCase(),c=t.crName.toLowerCase();return r<c?-1:r>c?1:0})),renderHtml()),"name-down"===this.value&&(clearHtml(),cards.sort((function(e,t){let r=e.crName.toLowerCase(),c=t.crName.toLowerCase();return r<c?1:r>c?-1:0})),renderHtml())}};function showProducts(e){e.forEach((e=>{cards.length<=9&&cards.push({crName:e.name,crImage:e.image,crPrice:e.price})}));for(let e=0;e<=cards.length-1;e++)cardsContaner.innerHTML+=`\n    <div class="container__card">\n      <div class="card__title">${cards[e].crName}</div>\n      <img class="card__image" width="100" src="${cards[e].crImage}" />\n      <div class="card__price">${"Цена: "+cards[e].crPrice+" руб."}</div>\n    </div>`}getProducts();let renderHtml=function(){for(let e=0;e<=cards.length-1;e++)cardsContaner.innerHTML+=`\n    <div class="container__card">\n      <div class="card__title">${cards[e].crName}</div>\n      <img class="card__image" width="100" src="${cards[e].crImage}" />\n      <div class="card__price">${"Цена: "+cards[e].crPrice+" руб."}</div>\n    </div>`},clearHtml=function(){for(let e=0;e<=cards.length-1;e++)cardsContaner.innerHTML=""},clearHtmlPages=function(){for(let e=0;e<=pages.length-1;e++)paginBox.innerHTML=""},filter=function(){let e=document.getElementById("search");e.addEventListener("keyup",(function(){let t=e.value.toLowerCase();document.querySelectorAll(".container__card").forEach((e=>{e.innerHTML.toLowerCase().indexOf(t)>-1?e.style.display="":e.style.display="none"}))}))};function showPagination(e){for(let t=1;t<=e;t++)pages.push(t);for(let e=0;e<pages.length-1;e++)paginBox.innerHTML+=`\n      <button class="usual-button">${pages[e]}</button>`;let t=document.querySelectorAll(".usual-button");for(let e=0;e<=t.length-1;e++)t[e].addEventListener("click",(function(){let r=t[e].textContent;clearHtml(),clearHtmlPages(),cards.splice(0),pages.splice(0);(async()=>{const e=await fetch("https://www.lenvendo.ru/api/js-test-task/?page="+r),t=await e.json();showProducts(t.products),showPagination(Math.ceil(t.total_count/t.products.length)),changeSort.onchange=function(){"price-up"===this.value&&(clearHtml(),cards.sort(((e,t)=>e.crPrice-t.crPrice)),renderHtml()),"price-down"===this.value&&(clearHtml(),cards.sort(((e,t)=>t.crPrice-e.crPrice)),renderHtml()),"name-up"===this.value&&(clearHtml(),cards.sort((function(e,t){let r=e.crName.toLowerCase(),c=t.crName.toLowerCase();return r<c?-1:r>c?1:0})),renderHtml()),"name-down"===this.value&&(clearHtml(),cards.sort((function(e,t){let r=e.crName.toLowerCase(),c=t.crName.toLowerCase();return r<c?1:r>c?-1:0})),renderHtml())}})()}))}filter();